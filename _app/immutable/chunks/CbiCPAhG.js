import"./Bzak7iHL.js";import{aA as tt,p as L,e as M,g as A,a as _,c as D,i as C,aw as j,f as oe,d as Te,h as te,r as Ae,al as de,an as Qe,av as Tt,B as Oe,j as lt,k as dt,s as rr,b as At,t as Mt,w as sr}from"./8W1ZFGhz.js";import{a as x,m as Pe,u as Le,k as rt}from"./DwBxj07P.js";import{i as H}from"./DyZeaouC.js";import{a as st,g as It,e as qt,f as Et}from"./qzIG6cGZ.js";import{p as Z,r as K,b as nr,s as $t}from"./BNZORXRz.js";import{b as nt,d as ee,m as it}from"./B8efuswh.js";import{d as ir,e as or,f as ar}from"./CZnHEgzM.js";import{a as cr,o as ot}from"./WtX1KPjl.js";import{I as xt}from"./D7ONiqf4.js";import{g as ur}from"./gnU0ypJ3.js";import{B as hr}from"./CoG0geaG.js";import{s as at}from"./qmm4bzaa.js";var lr=oe("<div><!></div>");function qn(r,e){const t=tt();L(e,!0);let s=Z(e,"id",19,()=>nt(t)),n=Z(e,"ref",15,null),i=Z(e,"level",3,2),o=K(e,["$$slots","$$events","$$legacy","id","ref","child","children","level"]);const a=ir.create({id:ee.with(()=>s()),level:ee.with(()=>i()),ref:ee.with(()=>n(),l=>n(l))}),c=j(()=>it(o,a.props));var u=M(),h=A(u);{var v=l=>{var y=M(),k=A(y);x(k,()=>e.child,()=>({props:C(c)})),_(l,y)},m=l=>{var y=lr();st(y,()=>({...C(c)}));var k=Te(y);x(k,()=>e.children??te),Ae(y),_(l,y)};H(h,l=>{e.child?l(v):l(m,!1)})}_(r,u),D()}var dr=oe("<button><!></button>");function En(r,e){const t=tt();L(e,!0);let s=Z(e,"id",19,()=>nt(t)),n=Z(e,"ref",15,null),i=Z(e,"disabled",3,!1),o=K(e,["$$slots","$$events","$$legacy","id","ref","children","child","disabled"]);const a=or.create({id:ee.with(()=>s()),ref:ee.with(()=>n(),l=>n(l)),disabled:ee.with(()=>!!i())}),c=j(()=>it(o,a.props));var u=M(),h=A(u);{var v=l=>{var y=M(),k=A(y);x(k,()=>e.child,()=>({props:C(c)})),_(l,y)},m=l=>{var y=dr();st(y,()=>({...C(c)}));var k=Te(y);x(k,()=>e.children??te),Ae(y),_(l,y)};H(h,l=>{e.child?l(v):l(m,!1)})}_(r,u),D()}var fr=oe("<div><!></div>");function $n(r,e){const t=tt();L(e,!0);let s=Z(e,"id",19,()=>nt(t)),n=Z(e,"ref",15,null),i=K(e,["$$slots","$$events","$$legacy","id","children","child","ref"]);const o=ar.create({id:ee.with(()=>s()),ref:ee.with(()=>n(),m=>n(m))}),a=j(()=>it(i,o.props));var c=M(),u=A(c);{var h=m=>{var l=M(),y=A(l);x(y,()=>e.child,()=>({props:C(a)})),_(m,l)},v=m=>{var l=fr();st(l,()=>({...C(a)}));var y=Te(l);x(y,()=>e.children??te),Ae(l),_(m,l)};H(u,m=>{e.child?m(h):m(v,!1)})}_(r,c),D()}const Ot="$$_clerk",fe=()=>{const r=de(Ot);if(!r)throw new Error("No Clerk data was found in Svelte context. Did you forget to wrap your component with ClerkProvider?");return r},xn=r=>{Qe(Ot,r)};function gr(r,e){L(e,!0);const t=fe();var s=M(),n=A(s);{var i=o=>{var a=M(),c=A(a);x(c,()=>e.children,()=>t.clerk),_(o,a)};H(n,o=>{t.isLoaded&&o(i)})}_(r,s),D()}var mr=oe("<div></div>"),yr=oe("<!> <!>",1);function pr(r,e){L(e,!0);const t=K(e,["$$slots","$$events","$$legacy","children"]);let s=lt(null),n=lt(!1),i=Tt(t);const o=fe();Qe("$$_userButton",{addCustomMenuItem(h,v){i.customMenuItems=[...i.customMenuItems||[],v]},addCustomPage(h){var v;i.userProfileProps={...i.userProfileProps,customPages:[...((v=i.userProfileProps)==null?void 0:v.customPages)||[],h]}}}),Oe(()=>{C(s)&&o.clerk&&(C(n)?o.clerk.__unstable__updateProps({node:C(s),props:i}):(o.clerk.mountUserButton(C(s),t),dt(n,!0)))}),cr(()=>{var h;C(n)&&((h=o.clerk)==null||h.unmountUserButton(C(s)))});var a=yr(),c=A(a);gr(c,{children:(h,v)=>{var m=mr();nr(m,l=>dt(s,l),()=>C(s)),_(h,m)},$$slots:{default:!0}});var u=rr(c,2);x(u,()=>e.children??te),_(r,a),D()}function De(r,e){var t=M(),s=A(t);x(s,()=>e.children),_(r,t)}function vr(r,e){L(e,!0);const{addCustomMenuItem:t}=de("$$_userButtonMenuItems"),s=K(e,["$$slots","$$events","$$legacy"]);ot(()=>{if(e.label==="manageAccount"||e.label==="signOut"){t("action",{label:e.label});return}const{label:n,onclick:i,open:o,labelIcon:a}=s;let c;t("action",{label:n,mountIcon(u){c=Pe(De,{target:u,props:{children:a}})},unmountIcon(){c&&Le(c)},...i?{onClick:i}:{open:o.startsWith("/")?o:`/${o}`}})}),D()}function br(r,e){L(e,!0);const{addCustomMenuItem:t}=de("$$_userButtonMenuItems");ot(()=>{let s;t("link",{label:e.label,mountIcon(n){s=Pe(De,{target:n,props:{children:e.labelIcon}})},unmountIcon(){s&&Le(s)},href:e.href})}),D()}function wr(r,e){L(e,!0);const t=de("$$_userButton");Qe("$$_userButtonMenuItems",t);var s=M(),n=A(s);x(n,()=>e.children),_(r,s),D()}function Sr(r,e){L(e,!0);const{addCustomPage:t}=de("$$_userButton");ot(()=>{let s,n;t({label:e.label,url:e.url,mountIcon(i){s=Pe(De,{target:i,props:{children:e.labelIcon}})},unmountIcon(){s&&Le(s)},mount(i){n=Pe(De,{target:i,props:{children:e.children}})},unmount(){n&&Le(n)}})}),D()}Object.assign(pr,{MenuItems:wr,Action:vr,Link:br,UserProfilePage:Sr});function On(r,e){L(e,!0);const t=fe();var s=M(),n=A(s);{var i=o=>{var a=M(),c=A(a);x(c,()=>e.children),_(o,a)};H(n,o=>{t.auth.userId&&o(i)})}_(r,s),D()}function Pn(r,e){L(e,!0);const t=fe();var s=M(),n=A(s);{var i=o=>{var a=M(),c=A(a);x(c,()=>e.children),_(o,a)};H(n,o=>{t.auth.userId===null&&o(i)})}_(r,s),D()}var kr=oe('<button type="button"><!></button>');function Ln(r,e){L(e,!0);const t=K(e,["$$slots","$$events","$$legacy","mode","children","style","class","asChild"]),s=fe();function n(){if(s.clerk){if(e.mode==="modal"){s.clerk.openSignIn(t);return}s.clerk.redirectToSignIn({...t,signInFallbackRedirectUrl:e.fallbackRedirectUrl,signInForceRedirectUrl:e.forceRedirectUrl})}}var i=M(),o=A(i);{var a=u=>{var h=M(),v=A(h);x(v,()=>e.children??te,()=>({signIn:n})),_(u,h)},c=u=>{var h=kr();h.__click=n;var v=Te(h);{var m=y=>{var k=M(),V=A(k);x(V,()=>e.children,()=>({signIn:n})),_(y,k)},l=y=>{var k=Mt("Sign in");_(y,k)};H(v,y=>{e.children?y(m):y(l,!1)})}Ae(h),At(()=>{It(h,e.style),qt(h,1,Et(e.class))}),_(u,h)};H(o,u=>{e.asChild?u(a):u(c,!1)})}_(r,i),D()}rt(["click"]);var _r=oe('<button type="button"><!></button>');function Dn(r,e){L(e,!0);const t=K(e,["$$slots","$$events","$$legacy","mode","children","style","class","asChild"]),s=fe();function n(){if(s.clerk){if(e.mode==="modal"){s.clerk.openSignUp(t);return}s.clerk.redirectToSignUp({...t,signUpFallbackRedirectUrl:e.fallbackRedirectUrl,signUpForceRedirectUrl:e.forceRedirectUrl})}}var i=M(),o=A(i);{var a=u=>{var h=M(),v=A(h);x(v,()=>e.children??te,()=>({signUp:n})),_(u,h)},c=u=>{var h=_r();h.__click=n;var v=Te(h);{var m=y=>{var k=M(),V=A(k);x(V,()=>e.children,()=>({signUp:n})),_(y,k)},l=y=>{var k=Mt("Sign up");_(y,k)};H(v,y=>{e.children?y(m):y(l,!1)})}Ae(h),At(()=>{It(h,e.style),qt(h,1,Et(e.class))}),_(u,h)};H(o,u=>{e.asChild?u(a):u(c,!1)})}_(r,i),D()}rt(["click"]);rt(["click"]);var Cr=(r,e="5.87.0")=>{if(r)return r;const t=Rr(e);return t?t==="snapshot"?"5.87.0":t:Tr(e)},Rr=r=>{var e;return(e=r.trim().replace(/^v/,"").match(/-(.+?)(\.|$)/))==null?void 0:e[1]},Tr=r=>r.trim().replace(/^v/,"").split(".")[0];function Ar(r){return r?Mr(r)||Pt(r):!0}function Mr(r){return/^http(s)?:\/\//.test(r||"")}function Pt(r){return r.startsWith("/")}function Ir(r){return r?Pt(r)?new URL(r,window.location.origin).toString():r:""}var qr=[".lcl.dev",".stg.dev",".lclstage.dev",".stgstage.dev",".dev.lclclerk.com",".stg.lclclerk.com",".accounts.lclclerk.com","accountsstage.dev","accounts.dev"];function Er(r){if(!r)return"";let e;if(r.match(/^(clerk\.)+\w*$/))e=/(clerk\.)*(?=clerk\.)/;else{if(r.match(/\.clerk.accounts/))return r;e=/^(clerk\.)*/gi}return`clerk.${r.replace(e,"")}`}var $r={initialDelay:125,maxDelayBetweenRetries:0,factor:2,shouldRetry:(r,e)=>e<5,retryImmediately:!1,jitter:!0},xr=100,Lt=async r=>new Promise(e=>setTimeout(e,r)),Dt=(r,e)=>e?r*(1+Math.random()):r,Or=r=>{let e=0;const t=()=>{const s=r.initialDelay,n=r.factor;let i=s*Math.pow(n,e);return i=Dt(i,r.jitter),Math.min(r.maxDelayBetweenRetries||i,i)};return async()=>{await Lt(t()),e++}},Pr=async(r,e={})=>{let t=0;const{shouldRetry:s,initialDelay:n,maxDelayBetweenRetries:i,factor:o,retryImmediately:a,jitter:c}={...$r,...e},u=Or({initialDelay:n,maxDelayBetweenRetries:i,factor:o,jitter:c});for(;;)try{return await r()}catch(h){if(t++,!s(h,t))throw h;a&&t===1?await Lt(Dt(xr,c)):await u()}},Lr="loadScript cannot be called when document does not exist",Dr="loadScript cannot be called without a src";async function Vr(r="",e){const{async:t,defer:s,beforeLoad:n,crossOrigin:i,nonce:o}=e||{};return Pr(()=>new Promise((c,u)=>{r||u(new Error(Dr)),(!document||!document.body)&&u(Lr);const h=document.createElement("script");i&&h.setAttribute("crossorigin",i),h.async=t||!1,h.defer=s||!1,h.addEventListener("load",()=>{h.remove(),c(h)}),h.addEventListener("error",()=>{h.remove(),u()}),h.src=r,h.nonce=o,n==null||n(h),document.body.appendChild(h)}),{shouldRetry:(c,u)=>u<=5})}var Fr=Object.freeze({InvalidProxyUrlErrorMessage:"The proxyUrl passed to Clerk is invalid. The expected value for proxyUrl is an absolute URL or a relative path with a leading '/'. (key={{url}})",InvalidPublishableKeyErrorMessage:"The publishableKey passed to Clerk is invalid. You can get your Publishable key at https://dashboard.clerk.com/last-active?path=api-keys. (key={{key}})",MissingPublishableKeyErrorMessage:"Missing publishableKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys.",MissingSecretKeyErrorMessage:"Missing secretKey. You can get your key at https://dashboard.clerk.com/last-active?path=api-keys.",MissingClerkProvider:"{{source}} can only be used within the <ClerkProvider /> component. Learn more: https://clerk.com/docs/components/clerk-provider"});function Ur({packageName:r,customMessages:e}){let t=r;function s(i,o){if(!o)return`${t}: ${i}`;let a=i;const c=i.matchAll(/{{([a-zA-Z0-9-_]+)}}/g);for(const u of c){const h=(o[u[1]]||"").toString();a=a.replace(`{{${u[1]}}}`,h)}return`${t}: ${a}`}const n={...Fr,...e};return{setPackageName({packageName:i}){return typeof i=="string"&&(t=i),this},setMessages({customMessages:i}){return Object.assign(n,i||{}),this},throwInvalidPublishableKeyError(i){throw new Error(s(n.InvalidPublishableKeyErrorMessage,i))},throwInvalidProxyUrl(i){throw new Error(s(n.InvalidProxyUrlErrorMessage,i))},throwMissingPublishableKeyError(){throw new Error(s(n.MissingPublishableKeyErrorMessage))},throwMissingSecretKeyError(){throw new Error(s(n.MissingSecretKeyErrorMessage))},throwMissingClerkProviderError(i){throw new Error(s(n.MissingClerkProvider,i))},throw(i){throw new Error(s(i))}}}var Vt=r=>typeof atob<"u"&&typeof atob=="function"?atob(r):typeof global<"u"&&global.Buffer?new global.Buffer(r,"base64").toString():r,Ft="pk_live_",Nr="pk_test_";function Ut(r){if(!r.endsWith("$"))return!1;const e=r.slice(0,-1);return e.includes("$")?!1:e.includes(".")}function ft(r,e={}){if(r=r||"",!r||!gt(r)){if(e.fatal&&!r)throw new Error("Publishable key is missing. Ensure that your publishable key is correctly configured. Double-check your environment configuration for your keys, or access them here: https://dashboard.clerk.com/last-active?path=api-keys");if(e.fatal&&!gt(r))throw new Error("Publishable key not valid.");return null}const t=r.startsWith(Ft)?"production":"development";let s;try{s=Vt(r.split("_")[2])}catch{if(e.fatal)throw new Error("Publishable key not valid: Failed to decode key.");return null}if(!Ut(s)){if(e.fatal)throw new Error("Publishable key not valid: Decoded key has invalid format.");return null}let n=s.slice(0,-1);return e.proxyUrl?n=e.proxyUrl:t!=="development"&&e.domain&&e.isSatellite&&(n=`clerk.${e.domain}`),{instanceType:t,frontendApi:n}}function gt(r=""){try{if(!(r.startsWith(Ft)||r.startsWith(Nr)))return!1;const t=r.split("_");if(t.length!==3)return!1;const s=t[2];if(!s)return!1;const n=Vt(s);return Ut(n)}catch{return!1}}function Qr(){const r=new Map;return{isDevOrStagingUrl:e=>{if(!e)return!1;const t=typeof e=="string"?e:e.hostname;let s=r.get(t);return s===void 0&&(s=qr.some(n=>t.endsWith(n)),r.set(t,s)),s}}}var Nt="Clerk: Failed to load Clerk",{isDevOrStagingUrl:Br}=Qr(),Qt=Ur({packageName:"@clerk/shared"});function Vn(r){Qt.setPackageName({packageName:r})}function ze(){if(typeof window>"u"||!window.Clerk)return!1;const r=window.Clerk;return typeof r=="object"&&typeof r.load=="function"}function mt(r){return new Promise((e,t)=>{let s=!1;const n=(u,h)=>{clearTimeout(u),clearInterval(h)},i=()=>{s||ze()&&(s=!0,n(a,c),e(null))},a=setTimeout(()=>{s||(s=!0,n(a,c),ze()?e(null):t(new Error(Nt)))},r);i();const c=setInterval(()=>{if(s){clearInterval(c);return}i()},100)})}var Fn=async r=>{const e=(r==null?void 0:r.scriptLoadTimeout)??15e3;if(ze())return null;if(document.querySelector("script[data-clerk-js-script]"))return mt(e);if(!(r!=null&&r.publishableKey))return Qt.throwMissingPublishableKeyError(),null;const s=mt(e);return Vr(Wr(r),{async:!0,crossOrigin:"anonymous",nonce:r.nonce,beforeLoad:Jr(r)}).catch(()=>{throw new Error(Nt)}),s},Wr=r=>{var h,v;const{clerkJSUrl:e,clerkJSVariant:t,clerkJSVersion:s,proxyUrl:n,domain:i,publishableKey:o}=r;if(e)return e;let a="";n&&Ar(n)?a=Ir(n).replace(/http(s)?:\/\//,""):i&&!Br(((h=ft(o))==null?void 0:h.frontendApi)||"")?a=Er(i):a=((v=ft(o))==null?void 0:v.frontendApi)||"";const c=t?`${t.replace(/\.+$/,"")}.`:"",u=Cr(s);return`https://${a}/npm/@clerk/clerk-js@${u}/dist/clerk.${c}browser.js`},jr=r=>{const e={};return r.publishableKey&&(e["data-clerk-publishable-key"]=r.publishableKey),r.proxyUrl&&(e["data-clerk-proxy-url"]=r.proxyUrl),r.domain&&(e["data-clerk-domain"]=r.domain),r.nonce&&(e.nonce=r.nonce),e},Jr=r=>e=>{const t=jr(r);for(const s in t)e.setAttribute(s,t[s])};function Un(r,e){L(e,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=K(e,["$$slots","$$events","$$legacy"]);const s=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 16v-4"}],["path",{d:"M12 8h.01"}]];xt(r,$t({name:"info"},()=>t,{get iconNode(){return s},children:(n,i)=>{var o=M(),a=A(o);x(a,()=>e.children??te),_(n,o)},$$slots:{default:!0}})),D()}function Nn(r,e){L(e,!0);/**
 * @license @lucide/svelte v0.544.0 - ISC
 *
 * ISC License
 *
 * Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2023 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2025.
 *
 * Permission to use, copy, modify, and/or distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 *
 * ---
 *
 * The MIT License (MIT) (for portions derived from Feather)
 *
 * Copyright (c) 2013-2023 Cole Bemis
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */let t=K(e,["$$slots","$$events","$$legacy"]);const s=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}]];xt(r,$t({name:"clipboard"},()=>t,{get iconNode(){return s},children:(n,i)=>{var o=M(),a=A(o);x(a,()=>e.children??te),_(n,o)},$$slots:{default:!0}})),D()}var xe={exports:{}},Hr=xe.exports,yt;function Yr(){return yt||(yt=1,(function(r,e){(function(t,s){r.exports=s()})(Hr,(function(){var t=1e3,s=6e4,n=36e5,i="millisecond",o="second",a="minute",c="hour",u="day",h="week",v="month",m="quarter",l="year",y="date",k="Invalid Date",V=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,Zt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,er={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(b){var g=["th","st","nd","rd"],d=b%100;return"["+b+(g[(d-20)%10]||g[d]||g[0])+"]"}},Be=function(b,g,d){var p=String(b);return!p||p.length>=g?b:""+Array(g+1-p.length).join(d)+b},tr={s:Be,z:function(b){var g=-b.utcOffset(),d=Math.abs(g),p=Math.floor(d/60),f=d%60;return(g<=0?"+":"-")+Be(p,2,"0")+":"+Be(f,2,"0")},m:function b(g,d){if(g.date()<d.date())return-b(d,g);var p=12*(d.year()-g.year())+(d.month()-g.month()),f=g.clone().add(p,v),w=d-f<0,S=g.clone().add(p+(w?-1:1),v);return+(-(p+(d-f)/(w?f-S:S-f))||0)},a:function(b){return b<0?Math.ceil(b)||0:Math.floor(b)},p:function(b){return{M:v,y:l,w:h,d:u,D:y,h:c,m:a,s:o,ms:i,Q:m}[b]||String(b||"").toLowerCase().replace(/s$/,"")},u:function(b){return b===void 0}},ge="en",re={};re[ge]=er;var ut="$isDayjsObject",We=function(b){return b instanceof Ie||!(!b||!b[ut])},Me=function b(g,d,p){var f;if(!g)return ge;if(typeof g=="string"){var w=g.toLowerCase();re[w]&&(f=w),d&&(re[w]=d,f=w);var S=g.split("-");if(!f&&S.length>1)return b(S[0])}else{var T=g.name;re[T]=g,f=T}return!p&&f&&(ge=f),f||!p&&ge},E=function(b,g){if(We(b))return b.clone();var d=typeof g=="object"?g:{};return d.date=b,d.args=arguments,new Ie(d)},R=tr;R.l=Me,R.i=We,R.w=function(b,g){return E(b,{locale:g.$L,utc:g.$u,x:g.$x,$offset:g.$offset})};var Ie=(function(){function b(d){this.$L=Me(d.locale,null,!0),this.parse(d),this.$x=this.$x||d.x||{},this[ut]=!0}var g=b.prototype;return g.parse=function(d){this.$d=(function(p){var f=p.date,w=p.utc;if(f===null)return new Date(NaN);if(R.u(f))return new Date;if(f instanceof Date)return new Date(f);if(typeof f=="string"&&!/Z$/i.test(f)){var S=f.match(V);if(S){var T=S[2]-1||0,I=(S[7]||"0").substring(0,3);return w?new Date(Date.UTC(S[1],T,S[3]||1,S[4]||0,S[5]||0,S[6]||0,I)):new Date(S[1],T,S[3]||1,S[4]||0,S[5]||0,S[6]||0,I)}}return new Date(f)})(d),this.init()},g.init=function(){var d=this.$d;this.$y=d.getFullYear(),this.$M=d.getMonth(),this.$D=d.getDate(),this.$W=d.getDay(),this.$H=d.getHours(),this.$m=d.getMinutes(),this.$s=d.getSeconds(),this.$ms=d.getMilliseconds()},g.$utils=function(){return R},g.isValid=function(){return this.$d.toString()!==k},g.isSame=function(d,p){var f=E(d);return this.startOf(p)<=f&&f<=this.endOf(p)},g.isAfter=function(d,p){return E(d)<this.startOf(p)},g.isBefore=function(d,p){return this.endOf(p)<E(d)},g.$g=function(d,p,f){return R.u(d)?this[p]:this.set(f,d)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(d,p){var f=this,w=!!R.u(p)||p,S=R.p(d),T=function(ne,F){var z=R.w(f.$u?Date.UTC(f.$y,F,ne):new Date(f.$y,F,ne),f);return w?z:z.endOf(u)},I=function(ne,F){return R.w(f.toDate()[ne].apply(f.toDate("s"),(w?[0,0,0,0]:[23,59,59,999]).slice(F)),f)},$=this.$W,O=this.$M,N=this.$D,ae="set"+(this.$u?"UTC":"");switch(S){case l:return w?T(1,0):T(31,11);case v:return w?T(1,O):T(0,O+1);case h:var se=this.$locale().weekStart||0,me=($<se?$+7:$)-se;return T(w?N-me:N+(6-me),O);case u:case y:return I(ae+"Hours",0);case c:return I(ae+"Minutes",1);case a:return I(ae+"Seconds",2);case o:return I(ae+"Milliseconds",3);default:return this.clone()}},g.endOf=function(d){return this.startOf(d,!1)},g.$set=function(d,p){var f,w=R.p(d),S="set"+(this.$u?"UTC":""),T=(f={},f[u]=S+"Date",f[y]=S+"Date",f[v]=S+"Month",f[l]=S+"FullYear",f[c]=S+"Hours",f[a]=S+"Minutes",f[o]=S+"Seconds",f[i]=S+"Milliseconds",f)[w],I=w===u?this.$D+(p-this.$W):p;if(w===v||w===l){var $=this.clone().set(y,1);$.$d[T](I),$.init(),this.$d=$.set(y,Math.min(this.$D,$.daysInMonth())).$d}else T&&this.$d[T](I);return this.init(),this},g.set=function(d,p){return this.clone().$set(d,p)},g.get=function(d){return this[R.p(d)]()},g.add=function(d,p){var f,w=this;d=Number(d);var S=R.p(p),T=function(O){var N=E(w);return R.w(N.date(N.date()+Math.round(O*d)),w)};if(S===v)return this.set(v,this.$M+d);if(S===l)return this.set(l,this.$y+d);if(S===u)return T(1);if(S===h)return T(7);var I=(f={},f[a]=s,f[c]=n,f[o]=t,f)[S]||1,$=this.$d.getTime()+d*I;return R.w($,this)},g.subtract=function(d,p){return this.add(-1*d,p)},g.format=function(d){var p=this,f=this.$locale();if(!this.isValid())return f.invalidDate||k;var w=d||"YYYY-MM-DDTHH:mm:ssZ",S=R.z(this),T=this.$H,I=this.$m,$=this.$M,O=f.weekdays,N=f.months,ae=f.meridiem,se=function(F,z,ye,qe){return F&&(F[z]||F(p,w))||ye[z].slice(0,qe)},me=function(F){return R.s(T%12||12,F,"0")},ne=ae||function(F,z,ye){var qe=F<12?"AM":"PM";return ye?qe.toLowerCase():qe};return w.replace(Zt,(function(F,z){return z||(function(ye){switch(ye){case"YY":return String(p.$y).slice(-2);case"YYYY":return R.s(p.$y,4,"0");case"M":return $+1;case"MM":return R.s($+1,2,"0");case"MMM":return se(f.monthsShort,$,N,3);case"MMMM":return se(N,$);case"D":return p.$D;case"DD":return R.s(p.$D,2,"0");case"d":return String(p.$W);case"dd":return se(f.weekdaysMin,p.$W,O,2);case"ddd":return se(f.weekdaysShort,p.$W,O,3);case"dddd":return O[p.$W];case"H":return String(T);case"HH":return R.s(T,2,"0");case"h":return me(1);case"hh":return me(2);case"a":return ne(T,I,!0);case"A":return ne(T,I,!1);case"m":return String(I);case"mm":return R.s(I,2,"0");case"s":return String(p.$s);case"ss":return R.s(p.$s,2,"0");case"SSS":return R.s(p.$ms,3,"0");case"Z":return S}return null})(F)||S.replace(":","")}))},g.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},g.diff=function(d,p,f){var w,S=this,T=R.p(p),I=E(d),$=(I.utcOffset()-this.utcOffset())*s,O=this-I,N=function(){return R.m(S,I)};switch(T){case l:w=N()/12;break;case v:w=N();break;case m:w=N()/3;break;case h:w=(O-$)/6048e5;break;case u:w=(O-$)/864e5;break;case c:w=O/n;break;case a:w=O/s;break;case o:w=O/t;break;default:w=O}return f?w:R.a(w)},g.daysInMonth=function(){return this.endOf(v).$D},g.$locale=function(){return re[this.$L]},g.locale=function(d,p){if(!d)return this.$L;var f=this.clone(),w=Me(d,p,!0);return w&&(f.$L=w),f},g.clone=function(){return R.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},b})(),ht=Ie.prototype;return E.prototype=ht,[["$ms",i],["$s",o],["$m",a],["$H",c],["$W",u],["$M",v],["$y",l],["$D",y]].forEach((function(b){ht[b[1]]=function(g){return this.$g(g,b[0],b[1])}})),E.extend=function(b,g){return b.$i||(b(g,Ie,E),b.$i=!0),E},E.locale=Me,E.isDayjs=We,E.unix=function(b){return E(1e3*b)},E.en=re[ge],E.Ls=re,E.p={},E}))})(xe)),xe.exports}var Kr=Yr();const Qn=ur(Kr),pt="1.25.4";var J=[],B=[],zr=Uint8Array,je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var ce=0,Xr=je.length;ce<Xr;++ce)J[ce]=je[ce],B[je.charCodeAt(ce)]=ce;B[45]=62;B[95]=63;function Gr(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var s=t===e?0:4-t%4;return[t,s]}function Zr(r,e,t){return(e+t)*3/4-t}function _e(r){var e,t=Gr(r),s=t[0],n=t[1],i=new zr(Zr(r,s,n)),o=0,a=n>0?s-4:s,c;for(c=0;c<a;c+=4)e=B[r.charCodeAt(c)]<<18|B[r.charCodeAt(c+1)]<<12|B[r.charCodeAt(c+2)]<<6|B[r.charCodeAt(c+3)],i[o++]=e>>16&255,i[o++]=e>>8&255,i[o++]=e&255;return n===2&&(e=B[r.charCodeAt(c)]<<2|B[r.charCodeAt(c+1)]>>4,i[o++]=e&255),n===1&&(e=B[r.charCodeAt(c)]<<10|B[r.charCodeAt(c+1)]<<4|B[r.charCodeAt(c+2)]>>2,i[o++]=e>>8&255,i[o++]=e&255),i}function es(r){return J[r>>18&63]+J[r>>12&63]+J[r>>6&63]+J[r&63]}function ts(r,e,t){for(var s,n=[],i=e;i<t;i+=3)s=(r[i]<<16&16711680)+(r[i+1]<<8&65280)+(r[i+2]&255),n.push(es(s));return n.join("")}function Ce(r){for(var e,t=r.length,s=t%3,n=[],i=16383,o=0,a=t-s;o<a;o+=i)n.push(ts(r,o,o+i>a?a:o+i));return s===1?(e=r[t-1],n.push(J[e>>2]+J[e<<4&63]+"==")):s===2&&(e=(r[t-2]<<8)+r[t-1],n.push(J[e>>10]+J[e>>4&63]+J[e<<2&63]+"=")),n.join("")}function X(r){if(r===void 0)return{};if(!Wt(r))throw new Error(`The arguments to a Convex function must be an object. Received: ${r}`);return r}function Bt(r){if(typeof r>"u")throw new Error("Client created with undefined deployment address. If you used an environment variable, check that it's set.");if(typeof r!="string")throw new Error(`Invalid deployment address: found ${r}".`);if(!(r.startsWith("http:")||r.startsWith("https:")))throw new Error(`Invalid deployment address: Must start with "https://" or "http://". Found "${r}".`);try{new URL(r)}catch{throw new Error(`Invalid deployment address: "${r}" is not a valid URL. If you believe this URL is correct, use the \`skipConvexDeploymentUrlCheck\` option to bypass this.`)}if(r.endsWith(".convex.site"))throw new Error(`Invalid deployment address: "${r}" ends with .convex.site, which is used for HTTP Actions. Convex deployment URLs typically end with .convex.cloud? If you believe this URL is correct, use the \`skipConvexDeploymentUrlCheck\` option to bypass this.`)}function Wt(r){var n;const e=typeof r=="object",t=Object.getPrototypeOf(r),s=t===null||t===Object.prototype||((n=t==null?void 0:t.constructor)==null?void 0:n.name)==="Object";return e&&s}const jt=!0,he=BigInt("-9223372036854775808"),ct=BigInt("9223372036854775807"),Xe=BigInt("0"),rs=BigInt("8"),ss=BigInt("256");function Jt(r){return Number.isNaN(r)||!Number.isFinite(r)||Object.is(r,-0)}function ns(r){r<Xe&&(r-=he+he);let e=r.toString(16);e.length%2===1&&(e="0"+e);const t=new Uint8Array(new ArrayBuffer(8));let s=0;for(const n of e.match(/.{2}/g).reverse())t.set([parseInt(n,16)],s++),r>>=rs;return Ce(t)}function is(r){const e=_e(r);if(e.byteLength!==8)throw new Error(`Received ${e.byteLength} bytes, expected 8 for $integer`);let t=Xe,s=Xe;for(const n of e)t+=BigInt(n)*ss**s,s++;return t>ct&&(t+=he+he),t}function os(r){if(r<he||ct<r)throw new Error(`BigInt ${r} does not fit into a 64-bit signed integer.`);const e=new ArrayBuffer(8);return new DataView(e).setBigInt64(0,r,!0),Ce(new Uint8Array(e))}function as(r){const e=_e(r);if(e.byteLength!==8)throw new Error(`Received ${e.byteLength} bytes, expected 8 for $integer`);return new DataView(e.buffer).getBigInt64(0,!0)}const cs=DataView.prototype.setBigInt64?os:ns,us=DataView.prototype.getBigInt64?as:is,vt=1024;function Ht(r){if(r.length>vt)throw new Error(`Field name ${r} exceeds maximum field name length ${vt}.`);if(r.startsWith("$"))throw new Error(`Field name ${r} starts with a '$', which is reserved.`);for(let e=0;e<r.length;e+=1){const t=r.charCodeAt(e);if(t<32||t>=127)throw new Error(`Field name ${r} has invalid character '${r[e]}': Field names can only contain non-control ASCII characters`)}}function le(r){if(r===null||typeof r=="boolean"||typeof r=="number"||typeof r=="string")return r;if(Array.isArray(r))return r.map(s=>le(s));if(typeof r!="object")throw new Error(`Unexpected type of ${r}`);const e=Object.entries(r);if(e.length===1){const s=e[0][0];if(s==="$bytes"){if(typeof r.$bytes!="string")throw new Error(`Malformed $bytes field on ${r}`);return _e(r.$bytes).buffer}if(s==="$integer"){if(typeof r.$integer!="string")throw new Error(`Malformed $integer field on ${r}`);return us(r.$integer)}if(s==="$float"){if(typeof r.$float!="string")throw new Error(`Malformed $float field on ${r}`);const n=_e(r.$float);if(n.byteLength!==8)throw new Error(`Received ${n.byteLength} bytes, expected 8 for $float`);const o=new DataView(n.buffer).getFloat64(0,jt);if(!Jt(o))throw new Error(`Float ${o} should be encoded as a number`);return o}if(s==="$set")throw new Error("Received a Set which is no longer supported as a Convex type.");if(s==="$map")throw new Error("Received a Map which is no longer supported as a Convex type.")}const t={};for(const[s,n]of Object.entries(r))Ht(s),t[s]=le(n);return t}function Se(r){return JSON.stringify(r,(e,t)=>t===void 0?"undefined":typeof t=="bigint"?`${t.toString()}n`:t)}function Ge(r,e,t,s){var o;if(r===void 0){const a=t&&` (present at path ${t} in original object ${Se(e)})`;throw new Error(`undefined is not a valid Convex value${a}. To learn about Convex's supported types, see https://docs.convex.dev/using/types.`)}if(r===null)return r;if(typeof r=="bigint"){if(r<he||ct<r)throw new Error(`BigInt ${r} does not fit into a 64-bit signed integer.`);return{$integer:cs(r)}}if(typeof r=="number")if(Jt(r)){const a=new ArrayBuffer(8);return new DataView(a).setFloat64(0,r,jt),{$float:Ce(new Uint8Array(a))}}else return r;if(typeof r=="boolean"||typeof r=="string")return r;if(r instanceof ArrayBuffer)return{$bytes:Ce(new Uint8Array(r))};if(Array.isArray(r))return r.map((a,c)=>Ge(a,e,t+`[${c}]`));if(r instanceof Set)throw new Error(Je(t,"Set",[...r],e));if(r instanceof Map)throw new Error(Je(t,"Map",[...r],e));if(!Wt(r)){const a=(o=r==null?void 0:r.constructor)==null?void 0:o.name,c=a?`${a} `:"";throw new Error(Je(t,c,r,e))}const n={},i=Object.entries(r);i.sort(([a,c],[u,h])=>a===u?0:a<u?-1:1);for(const[a,c]of i)c!==void 0&&(Ht(a),n[a]=Ge(c,e,t+`.${a}`));return n}function Je(r,e,t,s){return r?`${e}${Se(t)} is not a supported Convex type (present at path ${r} in original object ${Se(s)}). To learn about Convex's supported types, see https://docs.convex.dev/using/types.`:`${e}${Se(t)} is not a supported Convex type.`}function Y(r){return Ge(r,r,"")}var hs=Object.defineProperty,ls=(r,e,t)=>e in r?hs(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,He=(r,e,t)=>ls(r,typeof e!="symbol"?e+"":e,t),bt,wt;const ds=Symbol.for("ConvexError");class Ze extends(wt=Error,bt=ds,wt){constructor(e){super(typeof e=="string"?e:Se(e)),He(this,"name","ConvexError"),He(this,"data"),He(this,bt,!0),this.data=e}}var fs=Object.defineProperty,gs=(r,e,t)=>e in r?fs(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,St=(r,e,t)=>gs(r,typeof e!="symbol"?e+"":e,t);const ms="color:rgb(0, 145, 255)";function Yt(r){switch(r){case"query":return"Q";case"mutation":return"M";case"action":return"A";case"any":return"?"}}class Kt{constructor(e){St(this,"_onLogLineFuncs"),St(this,"_verbose"),this._onLogLineFuncs={},this._verbose=e.verbose}addLogLineListener(e){let t=Math.random().toString(36).substring(2,15);for(let s=0;s<10&&this._onLogLineFuncs[t]!==void 0;s++)t=Math.random().toString(36).substring(2,15);return this._onLogLineFuncs[t]=e,()=>{delete this._onLogLineFuncs[t]}}logVerbose(...e){if(this._verbose)for(const t of Object.values(this._onLogLineFuncs))t("debug",`${new Date().toISOString()}`,...e)}log(...e){for(const t of Object.values(this._onLogLineFuncs))t("info",...e)}warn(...e){for(const t of Object.values(this._onLogLineFuncs))t("warn",...e)}error(...e){for(const t of Object.values(this._onLogLineFuncs))t("error",...e)}}function ys(r){const e=new Kt(r);return e.addLogLineListener((t,...s)=>{switch(t){case"debug":console.debug(...s);break;case"info":console.log(...s);break;case"warn":console.warn(...s);break;case"error":console.error(...s);break;default:console.log(...s)}}),e}function ps(r){return new Kt(r)}function Ve(r,e,t,s,n){const i=Yt(t);if(typeof n=="object"&&(n=`ConvexError ${JSON.stringify(n.errorData,null,2)}`),e==="info"){const o=n.match(/^\[.*?\] /);if(o===null){r.error(`[CONVEX ${i}(${s})] Could not parse console.log`);return}const a=n.slice(1,o[0].length-2),c=n.slice(o[0].length);r.log(`%c[CONVEX ${i}(${s})] [${a}]`,ms,c)}else r.error(`[CONVEX ${i}(${s})] ${n}`)}function vs(r,e){const t=`[CONVEX FATAL ERROR] ${e}`;return r.error(t),new Error(t)}function ue(r,e,t){return`[CONVEX ${Yt(r)}(${e})] ${t.errorMessage}
  Called by client`}function et(r,e){return e.data=r.errorData,e}function Fe(r){const e=r.split(":");let t,s;return e.length===1?(t=e[0],s="default"):(t=e.slice(0,e.length-1).join(":"),s=e[e.length-1]),t.endsWith(".js")&&(t=t.slice(0,-3)),`${t}:${s}`}function ie(r,e){return JSON.stringify({udfPath:Fe(r),args:Y(e)})}var bs=Object.defineProperty,ws=(r,e,t)=>e in r?bs(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,W=(r,e,t)=>ws(r,typeof e!="symbol"?e+"":e,t);class Ss{constructor(){W(this,"nextQueryId"),W(this,"querySetVersion"),W(this,"querySet"),W(this,"queryIdToToken"),W(this,"identityVersion"),W(this,"auth"),W(this,"outstandingQueriesOlderThanRestart"),W(this,"outstandingAuthOlderThanRestart"),W(this,"paused"),W(this,"pendingQuerySetModifications"),this.nextQueryId=0,this.querySetVersion=0,this.identityVersion=0,this.querySet=new Map,this.queryIdToToken=new Map,this.outstandingQueriesOlderThanRestart=new Set,this.outstandingAuthOlderThanRestart=!1,this.paused=!1,this.pendingQuerySetModifications=new Map}hasSyncedPastLastReconnect(){return this.outstandingQueriesOlderThanRestart.size===0&&!this.outstandingAuthOlderThanRestart}markAuthCompletion(){this.outstandingAuthOlderThanRestart=!1}subscribe(e,t,s,n){const i=Fe(e),o=ie(i,t),a=this.querySet.get(o);if(a!==void 0)return a.numSubscribers+=1,{queryToken:o,modification:null,unsubscribe:()=>this.removeSubscriber(o)};{const c=this.nextQueryId++,u={id:c,canonicalizedUdfPath:i,args:t,numSubscribers:1,journal:s,componentPath:n};this.querySet.set(o,u),this.queryIdToToken.set(c,o);const h=this.querySetVersion,v=this.querySetVersion+1,m={type:"Add",queryId:c,udfPath:i,args:[Y(t)],journal:s,componentPath:n};return this.paused?this.pendingQuerySetModifications.set(c,m):this.querySetVersion=v,{queryToken:o,modification:{type:"ModifyQuerySet",baseVersion:h,newVersion:v,modifications:[m]},unsubscribe:()=>this.removeSubscriber(o)}}}transition(e){for(const t of e.modifications)switch(t.type){case"QueryUpdated":case"QueryFailed":{this.outstandingQueriesOlderThanRestart.delete(t.queryId);const s=t.journal;if(s!==void 0){const n=this.queryIdToToken.get(t.queryId);n!==void 0&&(this.querySet.get(n).journal=s)}break}case"QueryRemoved":{this.outstandingQueriesOlderThanRestart.delete(t.queryId);break}default:throw new Error(`Invalid modification ${t.type}`)}}queryId(e,t){const s=Fe(e),n=ie(s,t),i=this.querySet.get(n);return i!==void 0?i.id:null}isCurrentOrNewerAuthVersion(e){return e>=this.identityVersion}setAuth(e){this.auth={tokenType:"User",value:e};const t=this.identityVersion;return this.paused||(this.identityVersion=t+1),{type:"Authenticate",baseVersion:t,...this.auth}}setAdminAuth(e,t){const s={tokenType:"Admin",value:e,impersonating:t};this.auth=s;const n=this.identityVersion;return this.paused||(this.identityVersion=n+1),{type:"Authenticate",baseVersion:n,...s}}clearAuth(){this.auth=void 0,this.markAuthCompletion();const e=this.identityVersion;return this.paused||(this.identityVersion=e+1),{type:"Authenticate",tokenType:"None",baseVersion:e}}hasAuth(){return!!this.auth}isNewAuth(e){var t;return((t=this.auth)==null?void 0:t.value)!==e}queryPath(e){const t=this.queryIdToToken.get(e);return t?this.querySet.get(t).canonicalizedUdfPath:null}queryArgs(e){const t=this.queryIdToToken.get(e);return t?this.querySet.get(t).args:null}queryToken(e){return this.queryIdToToken.get(e)??null}queryJournal(e){var t;return(t=this.querySet.get(e))==null?void 0:t.journal}restart(e){this.unpause(),this.outstandingQueriesOlderThanRestart.clear();const t=[];for(const i of this.querySet.values()){const o={type:"Add",queryId:i.id,udfPath:i.canonicalizedUdfPath,args:[Y(i.args)],journal:i.journal,componentPath:i.componentPath};t.push(o),e.has(i.id)||this.outstandingQueriesOlderThanRestart.add(i.id)}this.querySetVersion=1;const s={type:"ModifyQuerySet",baseVersion:0,newVersion:1,modifications:t};if(!this.auth)return this.identityVersion=0,[s,void 0];this.outstandingAuthOlderThanRestart=!0;const n={type:"Authenticate",baseVersion:0,...this.auth};return this.identityVersion=1,[s,n]}pause(){this.paused=!0}resume(){const e=this.pendingQuerySetModifications.size>0?{type:"ModifyQuerySet",baseVersion:this.querySetVersion,newVersion:++this.querySetVersion,modifications:Array.from(this.pendingQuerySetModifications.values())}:void 0,t=this.auth!==void 0?{type:"Authenticate",baseVersion:this.identityVersion++,...this.auth}:void 0;return this.unpause(),[e,t]}unpause(){this.paused=!1,this.pendingQuerySetModifications.clear()}removeSubscriber(e){const t=this.querySet.get(e);if(t.numSubscribers>1)return t.numSubscribers-=1,null;{this.querySet.delete(e),this.queryIdToToken.delete(t.id),this.outstandingQueriesOlderThanRestart.delete(t.id);const s=this.querySetVersion,n=this.querySetVersion+1,i={type:"Remove",queryId:t.id};return this.paused?this.pendingQuerySetModifications.has(t.id)?this.pendingQuerySetModifications.delete(t.id):this.pendingQuerySetModifications.set(t.id,i):this.querySetVersion=n,{type:"ModifyQuerySet",baseVersion:s,newVersion:n,modifications:[i]}}}}var ks=Object.defineProperty,_s=(r,e,t)=>e in r?ks(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ee=(r,e,t)=>_s(r,typeof e!="symbol"?e+"":e,t);class Cs{constructor(e,t){this.logger=e,this.markConnectionStateDirty=t,Ee(this,"inflightRequests"),Ee(this,"requestsOlderThanRestart"),Ee(this,"inflightMutationsCount",0),Ee(this,"inflightActionsCount",0),this.inflightRequests=new Map,this.requestsOlderThanRestart=new Set}request(e,t){const s=new Promise(n=>{const i=t?"Requested":"NotSent";this.inflightRequests.set(e.requestId,{message:e,status:{status:i,requestedAt:new Date,onResult:n}}),e.type==="Mutation"?this.inflightMutationsCount++:e.type==="Action"&&this.inflightActionsCount++});return this.markConnectionStateDirty(),s}onResponse(e){const t=this.inflightRequests.get(e.requestId);if(t===void 0||t.status.status==="Completed")return null;const s=t.message.type==="Mutation"?"mutation":"action",n=t.message.udfPath;for(const c of e.logLines)Ve(this.logger,"info",s,n,c);const i=t.status;let o,a;if(e.success)o={success:!0,logLines:e.logLines,value:le(e.result)},a=()=>i.onResult(o);else{const c=e.result,{errorData:u}=e;Ve(this.logger,"error",s,n,c),o={success:!1,errorMessage:c,errorData:u!==void 0?le(u):void 0,logLines:e.logLines},a=()=>i.onResult(o)}return e.type==="ActionResponse"||!e.success?(a(),this.inflightRequests.delete(e.requestId),this.requestsOlderThanRestart.delete(e.requestId),t.message.type==="Action"?this.inflightActionsCount--:t.message.type==="Mutation"&&this.inflightMutationsCount--,this.markConnectionStateDirty(),{requestId:e.requestId,result:o}):(t.status={status:"Completed",result:o,ts:e.ts,onResolve:a},null)}removeCompleted(e){const t=new Map;for(const[s,n]of this.inflightRequests.entries()){const i=n.status;i.status==="Completed"&&i.ts.lessThanOrEqual(e)&&(i.onResolve(),t.set(s,i.result),n.message.type==="Mutation"?this.inflightMutationsCount--:n.message.type==="Action"&&this.inflightActionsCount--,this.inflightRequests.delete(s),this.requestsOlderThanRestart.delete(s))}return t.size>0&&this.markConnectionStateDirty(),t}restart(){this.requestsOlderThanRestart=new Set(this.inflightRequests.keys());const e=[];for(const[t,s]of this.inflightRequests){if(s.status.status==="NotSent"){s.status.status="Requested",e.push(s.message);continue}if(s.message.type==="Mutation")e.push(s.message);else if(s.message.type==="Action"){if(this.inflightRequests.delete(t),this.requestsOlderThanRestart.delete(t),this.inflightActionsCount--,s.status.status==="Completed")throw new Error("Action should never be in 'Completed' state");s.status.onResult({success:!1,errorMessage:"Connection lost while action was in flight",logLines:[]})}}return this.markConnectionStateDirty(),e}resume(){const e=[];for(const[,t]of this.inflightRequests)if(t.status.status==="NotSent"){t.status.status="Requested",e.push(t.message);continue}return e}hasIncompleteRequests(){for(const e of this.inflightRequests.values())if(e.status.status==="Requested")return!0;return!1}hasInflightRequests(){return this.inflightRequests.size>0}hasSyncedPastLastReconnect(){return this.requestsOlderThanRestart.size===0}timeOfOldestInflightRequest(){if(this.inflightRequests.size===0)return null;let e=Date.now();for(const t of this.inflightRequests.values())t.status.status!=="Completed"&&t.status.requestedAt.getTime()<e&&(e=t.status.requestedAt.getTime());return new Date(e)}inflightMutations(){return this.inflightMutationsCount}inflightActions(){return this.inflightActionsCount}}const Ue=Symbol.for("functionName"),Rs=Symbol.for("toReferencePath");function Ts(r){return r[Rs]??null}function As(r){return r.startsWith("function://")}function Ms(r){let e;if(typeof r=="string")As(r)?e={functionHandle:r}:e={name:r};else if(r[Ue])e={name:r[Ue]};else{const t=Ts(r);if(!t)throw new Error(`${r} is not a functionReference`);e={reference:t}}return e}function G(r){const e=Ms(r);if(e.name===void 0)throw e.functionHandle!==void 0?new Error(`Expected function reference like "api.file.func" or "internal.file.func", but received function handle ${e.functionHandle}`):e.reference!==void 0?new Error(`Expected function reference in the current component like "api.file.func" or "internal.file.func", but received reference ${e.reference}`):new Error(`Expected function reference like "api.file.func" or "internal.file.func", but received ${JSON.stringify(e)}`);if(typeof r=="string")return r;const t=r[Ue];if(!t)throw new Error(`${r} is not a functionReference`);return t}function zt(r=[]){const e={get(t,s){if(typeof s=="string"){const n=[...r,s];return zt(n)}else if(s===Ue){if(r.length<2){const o=["api",...r].join(".");throw new Error(`API path is expected to be of the form \`api.moduleName.functionName\`. Found: \`${o}\``)}const n=r.slice(0,-1).join("/"),i=r[r.length-1];return i==="default"?n:n+":"+i}else return s===Symbol.toStringTag?"FunctionReference":void 0}};return new Proxy({},e)}const Bn=zt();var Is=Object.defineProperty,qs=(r,e,t)=>e in r?Is(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ne=(r,e,t)=>qs(r,typeof e!="symbol"?e+"":e,t);class Re{constructor(e){Ne(this,"queryResults"),Ne(this,"modifiedQueries"),this.queryResults=e,this.modifiedQueries=[]}getQuery(e,...t){const s=X(t[0]),n=G(e),i=this.queryResults.get(ie(n,s));if(i!==void 0)return Re.queryValue(i.result)}getAllQueries(e){const t=[],s=G(e);for(const n of this.queryResults.values())n.udfPath===Fe(s)&&t.push({args:n.args,value:Re.queryValue(n.result)});return t}setQuery(e,t,s){const n=X(t),i=G(e),o=ie(i,n);let a;s===void 0?a=void 0:a={success:!0,value:s,logLines:[]};const c={udfPath:i,args:n,result:a};this.queryResults.set(o,c),this.modifiedQueries.push(o)}static queryValue(e){if(e!==void 0)return e.success?e.value:void 0}}class Es{constructor(){Ne(this,"queryResults"),Ne(this,"optimisticUpdates"),this.queryResults=new Map,this.optimisticUpdates=[]}ingestQueryResultsFromServer(e,t){this.optimisticUpdates=this.optimisticUpdates.filter(o=>!t.has(o.mutationId));const s=this.queryResults;this.queryResults=new Map(e);const n=new Re(this.queryResults);for(const o of this.optimisticUpdates)o.update(n);const i=[];for(const[o,a]of this.queryResults){const c=s.get(o);(c===void 0||c.result!==a.result)&&i.push(o)}return i}applyOptimisticUpdate(e,t){this.optimisticUpdates.push({update:e,mutationId:t});const s=new Re(this.queryResults);return e(s),s.modifiedQueries}rawQueryResult(e){return this.queryResults.get(e)}queryResult(e){const t=this.queryResults.get(e);if(t===void 0)return;const s=t.result;if(s!==void 0){if(s.success)return s.value;throw s.errorData!==void 0?et(s,new Ze(ue("query",t.udfPath,s))):new Error(ue("query",t.udfPath,s))}}hasQueryResult(e){return this.queryResults.get(e)!==void 0}queryLogs(e){var s;const t=this.queryResults.get(e);return(s=t==null?void 0:t.result)==null?void 0:s.logLines}}var $s=Object.defineProperty,xs=(r,e,t)=>e in r?$s(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Ye=(r,e,t)=>xs(r,typeof e!="symbol"?e+"":e,t);class U{constructor(e,t){Ye(this,"low"),Ye(this,"high"),Ye(this,"__isUnsignedLong__"),this.low=e|0,this.high=t|0,this.__isUnsignedLong__=!0}static isLong(e){return(e&&e.__isUnsignedLong__)===!0}static fromBytesLE(e){return new U(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24)}toBytesLE(){const e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]}static fromNumber(e){return isNaN(e)||e<0?kt:e>=Os?Ps:new U(e%ke|0,e/ke|0)}toString(){return(BigInt(this.high)*BigInt(ke)+BigInt(this.low)).toString()}equals(e){return U.isLong(e)||(e=U.fromValue(e)),this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low}notEquals(e){return!this.equals(e)}comp(e){return U.isLong(e)||(e=U.fromValue(e)),this.equals(e)?0:e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1}lessThanOrEqual(e){return this.comp(e)<=0}static fromValue(e){return typeof e=="number"?U.fromNumber(e):new U(e.low,e.high)}}const kt=new U(0,0),_t=65536,ke=_t*_t,Os=ke*ke,Ps=new U(-1,-1);var Ls=Object.defineProperty,Ds=(r,e,t)=>e in r?Ls(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,$e=(r,e,t)=>Ds(r,typeof e!="symbol"?e+"":e,t);class Ct{constructor(e,t){$e(this,"version"),$e(this,"remoteQuerySet"),$e(this,"queryPath"),$e(this,"logger"),this.version={querySet:0,ts:U.fromNumber(0),identity:0},this.remoteQuerySet=new Map,this.queryPath=e,this.logger=t}transition(e){const t=e.startVersion;if(this.version.querySet!==t.querySet||this.version.ts.notEquals(t.ts)||this.version.identity!==t.identity)throw new Error(`Invalid start version: ${t.ts.toString()}:${t.querySet}`);for(const s of e.modifications)switch(s.type){case"QueryUpdated":{const n=this.queryPath(s.queryId);if(n)for(const o of s.logLines)Ve(this.logger,"info","query",n,o);const i=le(s.value??null);this.remoteQuerySet.set(s.queryId,{success:!0,value:i,logLines:s.logLines});break}case"QueryFailed":{const n=this.queryPath(s.queryId);if(n)for(const o of s.logLines)Ve(this.logger,"info","query",n,o);const{errorData:i}=s;this.remoteQuerySet.set(s.queryId,{success:!1,errorMessage:s.errorMessage,errorData:i!==void 0?le(i):void 0,logLines:s.logLines});break}case"QueryRemoved":{this.remoteQuerySet.delete(s.queryId);break}default:throw new Error(`Invalid modification ${s.type}`)}this.version=e.endVersion}remoteQueryResults(){return this.remoteQuerySet}timestamp(){return this.version.ts}}function Ke(r){const e=_e(r);return U.fromBytesLE(Array.from(e))}function Vs(r){const e=new Uint8Array(r.toBytesLE());return Ce(e)}function Fs(r){switch(r.type){case"FatalError":case"AuthError":case"ActionResponse":case"Ping":return{...r};case"MutationResponse":return r.success?{...r,ts:Ke(r.ts)}:{...r};case"Transition":return{...r,startVersion:{...r.startVersion,ts:Ke(r.startVersion.ts)},endVersion:{...r.endVersion,ts:Ke(r.endVersion.ts)}}}}function Us(r){switch(r.type){case"Authenticate":case"ModifyQuerySet":case"Mutation":case"Action":case"Event":return{...r};case"Connect":return r.maxObservedTimestamp!==void 0?{...r,maxObservedTimestamp:Vs(r.maxObservedTimestamp)}:{...r,maxObservedTimestamp:void 0}}}var Ns=Object.defineProperty,Qs=(r,e,t)=>e in r?Ns(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,P=(r,e,t)=>Qs(r,typeof e!="symbol"?e+"":e,t);const Bs=1e3,Ws=1001,js=1005,Js=4040,Xt={InternalServerError:{timeout:1e3},SubscriptionsWorkerFullError:{timeout:3e3},TooManyConcurrentRequests:{timeout:3e3},CommitterFullError:{timeout:3e3},AwsTooManyRequestsException:{timeout:3e3},ExecuteFullError:{timeout:3e3},SystemTimeoutError:{timeout:3e3},ExpiredInQueue:{timeout:3e3},VectorIndexesUnavailable:{timeout:1e3},SearchIndexesUnavailable:{timeout:1e3},VectorIndexTooLarge:{timeout:3e3},SearchIndexTooLarge:{timeout:3e3},TooManyWritesInTimePeriod:{timeout:3e3}};function Hs(r){if(r===void 0)return"Unknown";for(const e of Object.keys(Xt))if(r.startsWith(e))return e;return"Unknown"}class Ys{constructor(e,t,s,n,i){this.markConnectionStateDirty=i,P(this,"socket"),P(this,"connectionCount"),P(this,"_hasEverConnected",!1),P(this,"lastCloseReason"),P(this,"defaultInitialBackoff"),P(this,"maxBackoff"),P(this,"retries"),P(this,"serverInactivityThreshold"),P(this,"reconnectDueToServerInactivityTimeout"),P(this,"uri"),P(this,"onOpen"),P(this,"onResume"),P(this,"onMessage"),P(this,"webSocketConstructor"),P(this,"logger"),P(this,"onServerDisconnectError"),this.webSocketConstructor=s,this.socket={state:"disconnected"},this.connectionCount=0,this.lastCloseReason="InitialConnect",this.defaultInitialBackoff=1e3,this.maxBackoff=16e3,this.retries=0,this.serverInactivityThreshold=3e4,this.reconnectDueToServerInactivityTimeout=null,this.uri=e,this.onOpen=t.onOpen,this.onResume=t.onResume,this.onMessage=t.onMessage,this.onServerDisconnectError=t.onServerDisconnectError,this.logger=n,this.connect()}setSocketState(e){this.socket=e,this._logVerbose(`socket state changed: ${this.socket.state}, paused: ${"paused"in this.socket?this.socket.paused:void 0}`),this.markConnectionStateDirty()}connect(){if(this.socket.state==="terminated")return;if(this.socket.state!=="disconnected"&&this.socket.state!=="stopped")throw new Error("Didn't start connection from disconnected state: "+this.socket.state);const e=new this.webSocketConstructor(this.uri);this._logVerbose("constructed WebSocket"),this.setSocketState({state:"connecting",ws:e,paused:"no"}),this.resetServerInactivityTimeout(),e.onopen=()=>{if(this.logger.logVerbose("begin ws.onopen"),this.socket.state!=="connecting")throw new Error("onopen called with socket not in connecting state");this.setSocketState({state:"ready",ws:e,paused:this.socket.paused==="yes"?"uninitialized":"no"}),this.resetServerInactivityTimeout(),this.socket.paused==="no"&&(this._hasEverConnected=!0,this.onOpen({connectionCount:this.connectionCount,lastCloseReason:this.lastCloseReason})),this.lastCloseReason!=="InitialConnect"&&this.logger.log("WebSocket reconnected"),this.connectionCount+=1,this.lastCloseReason=null},e.onerror=t=>{const s=t.message;this.logger.log(`WebSocket error: ${s}`)},e.onmessage=t=>{this.resetServerInactivityTimeout();const s=Fs(JSON.parse(t.data));this._logVerbose(`received ws message with type ${s.type}`),this.onMessage(s).hasSyncedPastLastReconnect&&(this.retries=0,this.markConnectionStateDirty())},e.onclose=t=>{if(this._logVerbose("begin ws.onclose"),this.lastCloseReason===null&&(this.lastCloseReason=t.reason??"OnCloseInvoked"),t.code!==Bs&&t.code!==Ws&&t.code!==js&&t.code!==Js){let n=`WebSocket closed with code ${t.code}`;t.reason&&(n+=`: ${t.reason}`),this.logger.log(n),this.onServerDisconnectError&&t.reason&&this.onServerDisconnectError(n)}const s=Hs(t.reason);this.scheduleReconnect(s)}}socketState(){return this.socket.state}sendMessage(e){const t={type:e.type,...e.type==="Authenticate"&&e.tokenType==="User"?{value:`...${e.value.slice(-7)}`}:{}};if(this.socket.state==="ready"&&this.socket.paused==="no"){const s=Us(e),n=JSON.stringify(s);try{this.socket.ws.send(n)}catch(i){this.logger.log(`Failed to send message on WebSocket, reconnecting: ${i}`),this.closeAndReconnect("FailedToSendMessage")}return this._logVerbose(`sent message with type ${e.type}: ${JSON.stringify(t)}`),!0}return this._logVerbose(`message not sent (socket state: ${this.socket.state}, paused: ${"paused"in this.socket?this.socket.paused:void 0}): ${JSON.stringify(t)}`),!1}resetServerInactivityTimeout(){this.socket.state!=="terminated"&&(this.reconnectDueToServerInactivityTimeout!==null&&(clearTimeout(this.reconnectDueToServerInactivityTimeout),this.reconnectDueToServerInactivityTimeout=null),this.reconnectDueToServerInactivityTimeout=setTimeout(()=>{this.closeAndReconnect("InactiveServer")},this.serverInactivityThreshold))}scheduleReconnect(e){this.socket={state:"disconnected"};const t=this.nextBackoff(e);this.markConnectionStateDirty(),this.logger.log(`Attempting reconnect in ${t}ms`),setTimeout(()=>this.connect(),t)}closeAndReconnect(e){switch(this._logVerbose(`begin closeAndReconnect with reason ${e}`),this.socket.state){case"disconnected":case"terminated":case"stopped":return;case"connecting":case"ready":{this.lastCloseReason=e,this.close(),this.scheduleReconnect("client");return}default:this.socket}}close(){switch(this.socket.state){case"disconnected":case"terminated":case"stopped":return Promise.resolve();case"connecting":{const e=this.socket.ws;return new Promise(t=>{e.onclose=()=>{this._logVerbose("Closed after connecting"),t()},e.onopen=()=>{this._logVerbose("Opened after connecting"),e.close()}})}case"ready":{this._logVerbose("ws.close called");const e=this.socket.ws,t=new Promise(s=>{e.onclose=()=>{s()}});return e.close(),t}default:return this.socket,Promise.resolve()}}terminate(){switch(this.reconnectDueToServerInactivityTimeout&&clearTimeout(this.reconnectDueToServerInactivityTimeout),this.socket.state){case"terminated":case"stopped":case"disconnected":case"connecting":case"ready":{const e=this.close();return this.setSocketState({state:"terminated"}),e}default:throw this.socket,new Error(`Invalid websocket state: ${this.socket.state}`)}}stop(){switch(this.socket.state){case"terminated":return Promise.resolve();case"connecting":case"stopped":case"disconnected":case"ready":{const e=this.close();return this.socket={state:"stopped"},e}default:return this.socket,Promise.resolve()}}tryRestart(){switch(this.socket.state){case"stopped":break;case"terminated":case"connecting":case"ready":case"disconnected":this.logger.logVerbose("Restart called without stopping first");return;default:this.socket}this.connect()}pause(){switch(this.socket.state){case"disconnected":case"stopped":case"terminated":return;case"connecting":case"ready":{this.socket={...this.socket,paused:"yes"};return}default:{this.socket;return}}}resume(){switch(this.socket.state){case"connecting":this.socket={...this.socket,paused:"no"};return;case"ready":this.socket.paused==="uninitialized"?(this.socket={...this.socket,paused:"no"},this.onOpen({connectionCount:this.connectionCount,lastCloseReason:this.lastCloseReason})):this.socket.paused==="yes"&&(this.socket={...this.socket,paused:"no"},this.onResume());return;case"terminated":case"stopped":case"disconnected":return;default:this.socket}this.connect()}connectionState(){return{isConnected:this.socket.state==="ready",hasEverConnected:this._hasEverConnected,connectionCount:this.connectionCount,connectionRetries:this.retries}}_logVerbose(e){this.logger.logVerbose(e)}nextBackoff(e){const s=(e==="client"?100:e==="Unknown"?this.defaultInitialBackoff:Xt[e].timeout)*Math.pow(2,this.retries);this.retries+=1;const n=Math.min(s,this.maxBackoff),i=n*(Math.random()-.5);return n+i}}function Ks(){return zs()}function zs(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{const e=Math.random()*16|0;return(r==="x"?e:e&3|8).toString(16)})}class we extends Error{}we.prototype.name="InvalidTokenError";function Xs(r){return decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let s=t.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s}))}function Gs(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return Xs(e)}catch{return atob(e)}}function Zs(r,e){if(typeof r!="string")throw new we("Invalid token specified: must be a string");e||(e={});const t=e.header===!0?0:1,s=r.split(".")[t];if(typeof s!="string")throw new we(`Invalid token specified: missing part #${t+1}`);let n;try{n=Gs(s)}catch(i){throw new we(`Invalid token specified: invalid base64 for part #${t+1} (${i.message})`)}try{return JSON.parse(n)}catch(i){throw new we(`Invalid token specified: invalid json for part #${t+1} (${i.message})`)}}var en=Object.defineProperty,tn=(r,e,t)=>e in r?en(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Q=(r,e,t)=>tn(r,typeof e!="symbol"?e+"":e,t);const rn=480*60*60*1e3,Rt=2;class sn{constructor(e,t,s){Q(this,"authState",{state:"noAuth"}),Q(this,"configVersion",0),Q(this,"syncState"),Q(this,"authenticate"),Q(this,"stopSocket"),Q(this,"tryRestartSocket"),Q(this,"pauseSocket"),Q(this,"resumeSocket"),Q(this,"clearAuth"),Q(this,"logger"),Q(this,"refreshTokenLeewaySeconds"),Q(this,"tokenConfirmationAttempts",0),this.syncState=e,this.authenticate=t.authenticate,this.stopSocket=t.stopSocket,this.tryRestartSocket=t.tryRestartSocket,this.pauseSocket=t.pauseSocket,this.resumeSocket=t.resumeSocket,this.clearAuth=t.clearAuth,this.logger=s.logger,this.refreshTokenLeewaySeconds=s.refreshTokenLeewaySeconds}async setConfig(e,t){this.resetAuthState(),this._logVerbose("pausing WS for auth token fetch"),this.pauseSocket();const s=await this.fetchTokenAndGuardAgainstRace(e,{forceRefreshToken:!1});s.isFromOutdatedConfig||(s.value?(this.setAuthState({state:"waitingForServerConfirmationOfCachedToken",config:{fetchToken:e,onAuthChange:t},hasRetried:!1}),this.authenticate(s.value)):(this.setAuthState({state:"initialRefetch",config:{fetchToken:e,onAuthChange:t}}),await this.refetchToken()),this._logVerbose("resuming WS after auth token fetch"),this.resumeSocket())}onTransition(e){if(this.syncState.isCurrentOrNewerAuthVersion(e.endVersion.identity)&&!(e.endVersion.identity<=e.startVersion.identity)){if(this.authState.state==="waitingForServerConfirmationOfCachedToken"){this._logVerbose("server confirmed auth token is valid"),this.refetchToken(),this.authState.config.onAuthChange(!0);return}this.authState.state==="waitingForServerConfirmationOfFreshToken"&&(this._logVerbose("server confirmed new auth token is valid"),this.scheduleTokenRefetch(this.authState.token),this.tokenConfirmationAttempts=0,this.authState.hadAuth||this.authState.config.onAuthChange(!0))}}onAuthError(e){if(e.authUpdateAttempted===!1&&(this.authState.state==="waitingForServerConfirmationOfFreshToken"||this.authState.state==="waitingForServerConfirmationOfCachedToken")){this._logVerbose("ignoring non-auth token expired error");return}const{baseVersion:t}=e;if(!this.syncState.isCurrentOrNewerAuthVersion(t+1)){this._logVerbose("ignoring auth error for previous auth attempt");return}this.tryToReauthenticate(e)}async tryToReauthenticate(e){if(this._logVerbose(`attempting to reauthenticate: ${e.error}`),this.authState.state==="noAuth"||this.authState.state==="waitingForServerConfirmationOfFreshToken"&&this.tokenConfirmationAttempts>=Rt){this.logger.error(`Failed to authenticate: "${e.error}", check your server auth config`),this.syncState.hasAuth()&&this.syncState.clearAuth(),this.authState.state!=="noAuth"&&this.setAndReportAuthFailed(this.authState.config.onAuthChange);return}this.authState.state==="waitingForServerConfirmationOfFreshToken"&&(this.tokenConfirmationAttempts++,this._logVerbose(`retrying reauthentication, ${Rt-this.tokenConfirmationAttempts} attempts remaining`)),await this.stopSocket();const t=await this.fetchTokenAndGuardAgainstRace(this.authState.config.fetchToken,{forceRefreshToken:!0});t.isFromOutdatedConfig||(t.value&&this.syncState.isNewAuth(t.value)?(this.authenticate(t.value),this.setAuthState({state:"waitingForServerConfirmationOfFreshToken",config:this.authState.config,token:t.value,hadAuth:this.authState.state==="notRefetching"||this.authState.state==="waitingForScheduledRefetch"})):(this._logVerbose("reauthentication failed, could not fetch a new token"),this.syncState.hasAuth()&&this.syncState.clearAuth(),this.setAndReportAuthFailed(this.authState.config.onAuthChange)),this.tryRestartSocket())}async refetchToken(){if(this.authState.state==="noAuth")return;this._logVerbose("refetching auth token");const e=await this.fetchTokenAndGuardAgainstRace(this.authState.config.fetchToken,{forceRefreshToken:!0});e.isFromOutdatedConfig||(e.value?this.syncState.isNewAuth(e.value)?(this.setAuthState({state:"waitingForServerConfirmationOfFreshToken",hadAuth:this.syncState.hasAuth(),token:e.value,config:this.authState.config}),this.authenticate(e.value)):this.setAuthState({state:"notRefetching",config:this.authState.config}):(this._logVerbose("refetching token failed"),this.syncState.hasAuth()&&this.clearAuth(),this.setAndReportAuthFailed(this.authState.config.onAuthChange)),this._logVerbose("restarting WS after auth token fetch (if currently stopped)"),this.tryRestartSocket())}scheduleTokenRefetch(e){if(this.authState.state==="noAuth")return;const t=this.decodeToken(e);if(!t){this.logger.error("Auth token is not a valid JWT, cannot refetch the token");return}const{iat:s,exp:n}=t;if(!s||!n){this.logger.error("Auth token does not have required fields, cannot refetch the token");return}const i=n-s;if(i<=2){this.logger.error("Auth token does not live long enough, cannot refetch the token");return}let o=Math.min(rn,(i-this.refreshTokenLeewaySeconds)*1e3);o<=0&&(this.logger.warn(`Refetching auth token immediately, configured leeway ${this.refreshTokenLeewaySeconds}s is larger than the token's lifetime ${i}s`),o=0);const a=setTimeout(()=>{this._logVerbose("running scheduled token refetch"),this.refetchToken()},o);this.setAuthState({state:"waitingForScheduledRefetch",refetchTokenTimeoutId:a,config:this.authState.config}),this._logVerbose(`scheduled preemptive auth token refetching in ${o}ms`)}async fetchTokenAndGuardAgainstRace(e,t){const s=++this.configVersion;this._logVerbose(`fetching token with config version ${s}`);const n=await e(t);return this.configVersion!==s?(this._logVerbose(`stale config version, expected ${s}, got ${this.configVersion}`),{isFromOutdatedConfig:!0}):{isFromOutdatedConfig:!1,value:n}}stop(){this.resetAuthState(),this.configVersion++,this._logVerbose(`config version bumped to ${this.configVersion}`)}setAndReportAuthFailed(e){e(!1),this.resetAuthState()}resetAuthState(){this.setAuthState({state:"noAuth"})}setAuthState(e){const t=e.state==="waitingForServerConfirmationOfFreshToken"?{hadAuth:e.hadAuth,state:e.state,token:`...${e.token.slice(-7)}`}:{state:e.state};switch(this._logVerbose(`setting auth state to ${JSON.stringify(t)}`),e.state){case"waitingForScheduledRefetch":case"notRefetching":case"noAuth":this.tokenConfirmationAttempts=0;break}this.authState.state==="waitingForScheduledRefetch"&&(clearTimeout(this.authState.refetchTokenTimeoutId),this.syncState.markAuthCompletion()),this.authState=e}decodeToken(e){try{return Zs(e)}catch(t){return this._logVerbose(`Error decoding token: ${t instanceof Error?t.message:"Unknown error"}`),null}}_logVerbose(e){this.logger.logVerbose(`${e} [v${this.configVersion}]`)}}const nn=["convexClientConstructed","convexWebSocketOpen","convexFirstMessageReceived"];function on(r,e){const t={sessionId:e};typeof performance>"u"||!performance.mark||performance.mark(r,{detail:t})}function an(r){let e=r.name.slice(6);return e=e.charAt(0).toLowerCase()+e.slice(1),{name:e,startTime:r.startTime}}function cn(r){if(typeof performance>"u"||!performance.getEntriesByName)return[];const e=[];for(const t of nn){const s=performance.getEntriesByName(t).filter(n=>n.entryType==="mark").filter(n=>n.detail.sessionId===r);e.push(...s)}return e.map(an)}var un=Object.defineProperty,hn=(r,e,t)=>e in r?un(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,q=(r,e,t)=>hn(r,typeof e!="symbol"?e+"":e,t);class ln{constructor(e,t,s){if(q(this,"address"),q(this,"state"),q(this,"requestManager"),q(this,"webSocketManager"),q(this,"authenticationManager"),q(this,"remoteQuerySet"),q(this,"optimisticQueryResults"),q(this,"_transitionHandlerCounter",0),q(this,"_nextRequestId"),q(this,"_onTransitionFns",new Map),q(this,"_sessionId"),q(this,"firstMessageReceived",!1),q(this,"debug"),q(this,"logger"),q(this,"maxObservedTimestamp"),q(this,"connectionStateSubscribers",new Map),q(this,"nextConnectionStateSubscriberId",0),q(this,"_lastPublishedConnectionState"),q(this,"markConnectionStateDirty",()=>{Promise.resolve().then(()=>{const m=this.connectionState();if(JSON.stringify(m)!==JSON.stringify(this._lastPublishedConnectionState)){this._lastPublishedConnectionState=m;for(const l of this.connectionStateSubscribers.values())l(m)}})}),q(this,"mark",m=>{this.debug&&on(m,this.sessionId)}),typeof e=="object")throw new Error("Passing a ClientConfig object is no longer supported. Pass the URL of the Convex deployment as a string directly.");(s==null?void 0:s.skipConvexDeploymentUrlCheck)!==!0&&Bt(e),s={...s};const n=s.authRefreshTokenLeewaySeconds??2;let i=s.webSocketConstructor;if(!i&&typeof WebSocket>"u")throw new Error("No WebSocket global variable defined! To use Convex in an environment without WebSocket try the HTTP client: https://docs.convex.dev/api/classes/browser.ConvexHttpClient");i=i||WebSocket,this.debug=s.reportDebugInfoToConvex??!1,this.address=e,this.logger=s.logger===!1?ps({verbose:s.verbose??!1}):s.logger!==!0&&s.logger?s.logger:ys({verbose:s.verbose??!1});const o=e.search("://");if(o===-1)throw new Error("Provided address was not an absolute URL.");const a=e.substring(o+3),c=e.substring(0,o);let u;if(c==="http")u="ws";else if(c==="https")u="wss";else throw new Error(`Unknown parent protocol ${c}`);const h=`${u}://${a}/api/${pt}/sync`;this.state=new Ss,this.remoteQuerySet=new Ct(m=>this.state.queryPath(m),this.logger),this.requestManager=new Cs(this.logger,this.markConnectionStateDirty),this.authenticationManager=new sn(this.state,{authenticate:m=>{const l=this.state.setAuth(m);return this.webSocketManager.sendMessage(l),l.baseVersion},stopSocket:()=>this.webSocketManager.stop(),tryRestartSocket:()=>this.webSocketManager.tryRestart(),pauseSocket:()=>{this.webSocketManager.pause(),this.state.pause()},resumeSocket:()=>this.webSocketManager.resume(),clearAuth:()=>{this.clearAuth()}},{logger:this.logger,refreshTokenLeewaySeconds:n}),this.optimisticQueryResults=new Es,this.addOnTransitionHandler(m=>{t(m.queries.map(l=>l.token))}),this._nextRequestId=0,this._sessionId=Ks();const{unsavedChangesWarning:v}=s;if(typeof window>"u"||typeof window.addEventListener>"u"){if(v===!0)throw new Error("unsavedChangesWarning requested, but window.addEventListener not found! Remove {unsavedChangesWarning: true} from Convex client options.")}else v!==!1&&window.addEventListener("beforeunload",m=>{if(this.requestManager.hasIncompleteRequests()){m.preventDefault();const l="Are you sure you want to leave? Your changes may not be saved.";return(m||window.event).returnValue=l,l}});this.webSocketManager=new Ys(h,{onOpen:m=>{this.mark("convexWebSocketOpen"),this.webSocketManager.sendMessage({...m,type:"Connect",sessionId:this._sessionId,maxObservedTimestamp:this.maxObservedTimestamp});const l=new Set(this.remoteQuerySet.remoteQueryResults().keys());this.remoteQuerySet=new Ct(V=>this.state.queryPath(V),this.logger);const[y,k]=this.state.restart(l);k&&this.webSocketManager.sendMessage(k),this.webSocketManager.sendMessage(y);for(const V of this.requestManager.restart())this.webSocketManager.sendMessage(V)},onResume:()=>{const[m,l]=this.state.resume();l&&this.webSocketManager.sendMessage(l),m&&this.webSocketManager.sendMessage(m);for(const y of this.requestManager.resume())this.webSocketManager.sendMessage(y)},onMessage:m=>{switch(this.firstMessageReceived||(this.firstMessageReceived=!0,this.mark("convexFirstMessageReceived"),this.reportMarks()),m.type){case"Transition":{this.observedTimestamp(m.endVersion.ts),this.authenticationManager.onTransition(m),this.remoteQuerySet.transition(m),this.state.transition(m);const l=this.requestManager.removeCompleted(this.remoteQuerySet.timestamp());this.notifyOnQueryResultChanges(l);break}case"MutationResponse":{m.success&&this.observedTimestamp(m.ts);const l=this.requestManager.onResponse(m);l!==null&&this.notifyOnQueryResultChanges(new Map([[l.requestId,l.result]]));break}case"ActionResponse":{this.requestManager.onResponse(m);break}case"AuthError":{this.authenticationManager.onAuthError(m);break}case"FatalError":{const l=vs(this.logger,m.error);throw this.webSocketManager.terminate(),l}}return{hasSyncedPastLastReconnect:this.hasSyncedPastLastReconnect()}},onServerDisconnectError:s.onServerDisconnectError},i,this.logger,this.markConnectionStateDirty),this.mark("convexClientConstructed")}hasSyncedPastLastReconnect(){return this.requestManager.hasSyncedPastLastReconnect()||this.state.hasSyncedPastLastReconnect()}observedTimestamp(e){(this.maxObservedTimestamp===void 0||this.maxObservedTimestamp.lessThanOrEqual(e))&&(this.maxObservedTimestamp=e)}getMaxObservedTimestamp(){return this.maxObservedTimestamp}notifyOnQueryResultChanges(e){const t=this.remoteQuerySet.remoteQueryResults(),s=new Map;for(const[i,o]of t){const a=this.state.queryToken(i);if(a!==null){const c={result:o,udfPath:this.state.queryPath(i),args:this.state.queryArgs(i)};s.set(a,c)}}const n=this.optimisticQueryResults.ingestQueryResultsFromServer(s,new Set(e.keys()));this.handleTransition({queries:n.map(i=>{const o=this.optimisticQueryResults.rawQueryResult(i);return{token:i,modification:{kind:"Updated",result:o.result}}}),reflectedMutations:Array.from(e).map(([i,o])=>({requestId:i,result:o})),timestamp:this.remoteQuerySet.timestamp()})}handleTransition(e){for(const t of this._onTransitionFns.values())t(e)}addOnTransitionHandler(e){const t=this._transitionHandlerCounter++;return this._onTransitionFns.set(t,e),()=>this._onTransitionFns.delete(t)}setAuth(e,t){this.authenticationManager.setConfig(e,t)}hasAuth(){return this.state.hasAuth()}setAdminAuth(e,t){const s=this.state.setAdminAuth(e,t);this.webSocketManager.sendMessage(s)}clearAuth(){const e=this.state.clearAuth();this.webSocketManager.sendMessage(e)}subscribe(e,t,s){const n=X(t),{modification:i,queryToken:o,unsubscribe:a}=this.state.subscribe(e,n,s==null?void 0:s.journal,s==null?void 0:s.componentPath);return i!==null&&this.webSocketManager.sendMessage(i),{queryToken:o,unsubscribe:()=>{const c=a();c&&this.webSocketManager.sendMessage(c)}}}localQueryResult(e,t){const s=X(t),n=ie(e,s);return this.optimisticQueryResults.queryResult(n)}localQueryResultByToken(e){return this.optimisticQueryResults.queryResult(e)}hasLocalQueryResultByToken(e){return this.optimisticQueryResults.hasQueryResult(e)}localQueryLogs(e,t){const s=X(t),n=ie(e,s);return this.optimisticQueryResults.queryLogs(n)}queryJournal(e,t){const s=X(t),n=ie(e,s);return this.state.queryJournal(n)}connectionState(){const e=this.webSocketManager.connectionState();return{hasInflightRequests:this.requestManager.hasInflightRequests(),isWebSocketConnected:e.isConnected,hasEverConnected:e.hasEverConnected,connectionCount:e.connectionCount,connectionRetries:e.connectionRetries,timeOfOldestInflightRequest:this.requestManager.timeOfOldestInflightRequest(),inflightMutations:this.requestManager.inflightMutations(),inflightActions:this.requestManager.inflightActions()}}subscribeToConnectionState(e){const t=this.nextConnectionStateSubscriberId++;return this.connectionStateSubscribers.set(t,e),()=>{this.connectionStateSubscribers.delete(t)}}async mutation(e,t,s){const n=await this.mutationInternal(e,t,s);if(!n.success)throw n.errorData!==void 0?et(n,new Ze(ue("mutation",e,n))):new Error(ue("mutation",e,n));return n.value}async mutationInternal(e,t,s,n){const{mutationPromise:i}=this.enqueueMutation(e,t,s,n);return i}enqueueMutation(e,t,s,n){const i=X(t);this.tryReportLongDisconnect();const o=this.nextRequestId;if(this._nextRequestId++,s!==void 0){const h=s.optimisticUpdate;if(h!==void 0){const v=y=>{h(y,i)instanceof Promise&&this.logger.warn("Optimistic update handler returned a Promise. Optimistic updates should be synchronous.")},l=this.optimisticQueryResults.applyOptimisticUpdate(v,o).map(y=>{const k=this.localQueryResultByToken(y);return{token:y,modification:{kind:"Updated",result:k===void 0?void 0:{success:!0,value:k,logLines:[]}}}});this.handleTransition({queries:l,reflectedMutations:[],timestamp:this.remoteQuerySet.timestamp()})}}const a={type:"Mutation",requestId:o,udfPath:e,componentPath:n,args:[Y(i)]},c=this.webSocketManager.sendMessage(a),u=this.requestManager.request(a,c);return{requestId:o,mutationPromise:u}}async action(e,t){const s=await this.actionInternal(e,t);if(!s.success)throw s.errorData!==void 0?et(s,new Ze(ue("action",e,s))):new Error(ue("action",e,s));return s.value}async actionInternal(e,t,s){const n=X(t),i=this.nextRequestId;this._nextRequestId++,this.tryReportLongDisconnect();const o={type:"Action",requestId:i,udfPath:e,componentPath:s,args:[Y(n)]},a=this.webSocketManager.sendMessage(o);return this.requestManager.request(o,a)}async close(){return this.authenticationManager.stop(),this.webSocketManager.terminate()}get url(){return this.address}get nextRequestId(){return this._nextRequestId}get sessionId(){return this._sessionId}reportMarks(){if(this.debug){const e=cn(this.sessionId);this.webSocketManager.sendMessage({type:"Event",eventType:"ClientConnect",event:e})}}tryReportLongDisconnect(){if(!this.debug)return;const e=this.connectionState().timeOfOldestInflightRequest;if(e===null||Date.now()-e.getTime()<=60*1e3)return;const t=`${this.address}/api/debug_event`;fetch(t,{method:"POST",headers:{"Content-Type":"application/json","Convex-Client":`npm-${pt}`},body:JSON.stringify({event:"LongWebsocketDisconnect"})}).then(s=>{s.ok||this.logger.warn("Analytics request failed with response:",s.body)}).catch(s=>{this.logger.warn("Analytics response failed with error:",s)})}}var dn=Object.defineProperty,fn=(r,e,t)=>e in r?dn(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,pe=(r,e,t)=>fn(r,typeof e!="symbol"?e+"":e,t);class gn{constructor(e,t={}){pe(this,"listeners"),pe(this,"_client"),pe(this,"callNewListenersWithCurrentValuesTimer"),pe(this,"_closed"),pe(this,"_disabled"),t.skipConvexDeploymentUrlCheck!==!0&&Bt(e);const{disabled:s,...n}=t;this._closed=!1,this._disabled=!!s,typeof window>"u"&&!("unsavedChangesWarning"in n)&&(n.unsavedChangesWarning=!1),this.disabled||(this._client=new ln(e,i=>this._transition(i),n)),this.listeners=new Set}get closed(){return this._closed}get client(){if(this._client)return this._client;throw new Error("ConvexClient is disabled")}get disabled(){return this._disabled}onUpdate(e,t,s,n){if(this.disabled){const h=()=>{};return Object.assign(h,{unsubscribe:h,getCurrentValue:()=>{},getQueryLogs:()=>{}}),h}const{queryToken:i,unsubscribe:o}=this.client.subscribe(G(e),t),a={queryToken:i,callback:s,onError:n,unsubscribe:o,hasEverRun:!1,query:e,args:t};this.listeners.add(a),this.queryResultReady(i)&&this.callNewListenersWithCurrentValuesTimer===void 0&&(this.callNewListenersWithCurrentValuesTimer=setTimeout(()=>this.callNewListenersWithCurrentValues(),0));const c={unsubscribe:()=>{this.closed||(this.listeners.delete(a),o())},getCurrentValue:()=>this.client.localQueryResultByToken(i),getQueryLogs:()=>this.client.localQueryLogs(i)},u=c.unsubscribe;return Object.assign(u,c),u}callNewListenersWithCurrentValues(){this.callNewListenersWithCurrentValuesTimer=void 0,this._transition([],!0)}queryResultReady(e){return this.client.hasLocalQueryResultByToken(e)}async close(){if(!this.disabled)return this.listeners.clear(),this._closed=!0,this.client.close()}setAuth(e,t){this.disabled||this.client.setAuth(e,t??(()=>{}))}setAdminAuth(e,t){if(this.closed)throw new Error("ConvexClient has already been closed.");this.disabled||this.client.setAdminAuth(e,t)}_transition(e,t=!1){for(const s of this.listeners){const{callback:n,queryToken:i,onError:o,hasEverRun:a}=s;if(e.includes(i)||t&&!a&&this.client.hasLocalQueryResultByToken(i)){s.hasEverRun=!0;let c;try{c=this.client.localQueryResultByToken(i)}catch(u){if(!(u instanceof Error))throw u;o?o(u,"Second argument to onUpdate onError is reserved for later use"):Promise.reject(u);continue}n(c,"Second argument to onUpdate callback is reserved for later use")}}}async mutation(e,t,s){if(this.disabled)throw new Error("ConvexClient is disabled");return await this.client.mutation(G(e),t,s)}async action(e,t){if(this.disabled)throw new Error("ConvexClient is disabled");return await this.client.action(G(e),t)}async query(e,t){if(this.disabled)throw new Error("ConvexClient is disabled");const s=this.client.localQueryResult(G(e),t);return s!==void 0?Promise.resolve(s):new Promise((n,i)=>{const{unsubscribe:o}=this.onUpdate(e,t,a=>{o(),n(a)},a=>{o(),i(a)})})}connectionState(){if(this.disabled)throw new Error("ConvexClient is disabled");return this.client.connectionState()}subscribeToConnectionState(e){return this.disabled?()=>{}:this.client.subscribeToConnectionState(e)}}const Gt="$$_convexClient",mn=()=>{const r=de(Gt);if(!r)throw new Error("No ConvexClient was found in Svelte context. Did you forget to call setupConvex() in a parent component?");return r},yn=r=>{Qe(Gt,r)},Wn=(r,e={})=>{const t={disabled:!hr,...e},s=new gn(r,t);yn(s),Oe(()=>()=>s.close())};function jn(r,e,t={}){const s=mn();if(typeof r=="string")throw new Error("Query must be a functionReference object, not a string");const n=Tt({result:be(t).initialData,argsForLastResult:void 0,lastResult:void 0,haveArgsEverChanged:!1});Oe(()=>{const l=ve(e);return s.onUpdate(r,l,k=>{const V=structuredClone(k);n.result=V,n.argsForLastResult=l,n.lastResult=V},k=>{n.result=k,n.argsForLastResult=l;const V=structuredClone(k);n.lastResult=V})});const i=j(()=>!!n.argsForLastResult&&JSON.stringify(Y(n.argsForLastResult))===JSON.stringify(Y(ve(e)))),o=j(()=>!!(be(t).keepPreviousData&&n.lastResult)),a=ve(e);Oe(()=>{sr(()=>n.haveArgsEverChanged)||JSON.stringify(Y(ve(e)))!==JSON.stringify(Y(a))&&(n.haveArgsEverChanged=!0,be(t).initialData!==void 0&&(n.argsForLastResult=at(a),n.lastResult=be(t).initialData))});const c=j(()=>{if(be(t).initialData&&!n.haveArgsEverChanged)return n.result;let y;try{y=s.disabled?void 0:s.client.localQueryResult(G(r),ve(e))}catch(k){if(!(k instanceof Error))throw console.error("threw non-Error instance",k),k;y=k}return n.result,y}),u=j(()=>C(c)!==void 0?C(c):C(o)?n.lastResult:void 0),h=j(()=>C(c)===void 0&&C(o)&&!C(i)&&C(u)!==void 0),v=j(()=>{if(!(C(u)instanceof Error))return C(u)}),m=j(()=>{if(C(u)instanceof Error)return C(u)});return{get data(){return C(v)},get isLoading(){return C(m)===void 0&&C(v)===void 0},get error(){return C(m)},get isStale(){return C(h)}}}function ve(r){return typeof r=="function"&&(r=r()),at(r)}function be(r){return typeof r=="function"&&(r=r()),at(r)}export{Nn as C,En as D,Un as I,On as S,Bn as a,qn as b,$n as c,Qn as d,jn as e,mn as f,Pn as g,gr as h,xn as i,Ln as j,Dn as k,Fn as l,Wn as m,Vn as s,fe as u};
